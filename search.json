[{"path":[]},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/01-linear.html","id":"normal-linear-regression","dir":"Articles > Web_only","previous_headings":"","what":"Normal Linear Regression","title":"Linear Models","text":"consider following model \\[ \\begin{aligned} p(y|\\beta,\\Sigma) &= \\text{Normal}(y|X\\beta, \\Sigma) \\\\ p(\\beta) &= \\text{Normal}(\\beta|\\mu_0, \\Sigma_0) \\end{aligned} \\] often assuming \\(\\Sigma = \\sigma^2 I_N\\) either \\(p(\\sigma^2) = \\text{Inverse-Gamma}(\\sigma^2|a_0, b_0)\\) \\(p(\\sigma) = \\text{Half-}t(\\sigma^2|a_0,b_0)\\). (Look generalisation using G-Wishart priors Maestrini Wand 2020) latter can expressed \\[ \\begin{aligned} p(\\sigma^2|\\lambda) &= \\text{Inverse-Gamma}(b_0/2, b_0/\\lambda) \\\\ p(\\lambda) &= \\text{Inverse-Gamma}(1/2,1/a_0^2) \\\\ \\implies p(\\sigma) &= \\text{Half-}t(a_0,b_0). \\end{aligned} \\] proposed product-form variational densities \\(q(\\beta,\\Sigma,\\lambda)=q(\\beta)q(\\Sigma)q(\\lambda)\\) optimal solutions \\[ \\begin{aligned} q^\\star(\\beta) &\\propto \\exp\\left\\{\\mathbb E_{\\Sigma}\\left[\\ln p(\\beta|y,\\Sigma)\\right]\\right\\} \\\\ q^\\star(\\Sigma) &\\propto \\exp\\left\\{\\mathbb E_{\\beta,\\lambda}\\left[\\ln p(\\Sigma|y,\\beta,\\lambda)\\right]\\right\\} \\\\ q^\\star(\\lambda) &\\propto \\exp\\left\\{\\mathbb E_\\Sigma[\\ln p(\\lambda|y,\\Sigma)\\right\\} \\end{aligned} \\] \\(\\lambda\\) parameter dropped needed. model , joint density \\(\\ln p(y,\\beta,\\Sigma) = \\ln p(y|\\beta,\\Sigma) + \\ln p(\\beta) + \\ln p(\\Sigma|\\lambda) + \\ln p(\\lambda)\\).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/01-linear.html","id":"model-likelihood","dir":"Articles > Web_only","previous_headings":"Normal Linear Regression","what":"Model Likelihood","title":"Linear Models","text":"log-likelihood form \\[ \\ln p(y|\\beta,\\Sigma) = -\\frac{1}{2}\\left(\\ln |\\Sigma| +(y-X\\beta)^{\\mathsf{T}}\\Sigma^{-1}(y-X\\beta)+p\\ln(2\\pi)\\right) \\] \\[ \\begin{aligned} \\mathbb E_q[\\ln p(y|\\beta,\\Sigma)] &= -\\frac{1}{2}\\left(\\mathbb E_q[\\ln|\\Sigma|] + \\mathbb E_q[(y-X\\beta)^{\\mathsf{T}}\\Sigma^{-1}(y-X\\beta)]+p\\ln(2\\pi)\\right) \\\\ &= -\\frac{1}{2}\\left(\\mathbb E_q[\\ln|\\Sigma|] + (y-X\\mu_\\beta)^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}](y-X\\mu_\\beta) + \\text{tr}\\left(X^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}]X\\Sigma_\\beta\\right)+p\\ln(2\\pi)\\right) \\end{aligned} \\] due assumed variational independence \\(\\beta\\) \\(\\Sigma\\). obtain , (letting \\(\\mu_\\beta = \\mathbb E_q[\\beta]\\) \\(\\Sigma_\\beta = \\mathbb V_q[\\beta]\\)) \\[ \\begin{aligned} \\mathbb E_q[(y-X\\beta)^{\\mathsf{T}}\\Sigma^{-1}(y-X\\beta)] &= y^\\mathsf{T}\\mathbb E_q[\\Sigma{-1}]y-2y^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}]X\\mathbb E_q[\\beta]+\\mathbb E_q[\\beta^\\mathsf{T}X^\\mathsf{T}\\Sigma^{-1}X\\beta]\\\\ \\mathbb E_q[\\beta^\\mathsf{T}X^\\mathsf{T}\\Sigma^{-1}X\\beta] &= \\mathbb E_q[\\text{tr}\\left(X^\\mathsf{T}\\Sigma^{-1}X\\beta\\beta^\\mathsf{T}\\right)] \\\\ &= \\text{tr}\\left(X^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}]X\\left\\{\\mathbb V_q[\\beta]+\\mathbb E_q[\\beta]\\mathbb E_q[\\beta]^\\mathsf{T}\\right\\}\\right) \\\\ &= \\text{tr}\\left(X^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}]X\\mathbb V_q[\\beta]\\right)+(X\\mathbb E_q[\\beta])^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}]X\\mathbb E_q[\\beta]\\\\ y^\\mathsf{T}\\mathbb E_q[\\Sigma{-1}]y-2y^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}]X\\mathbb E_q[\\beta] &= (y-X\\mathbb E_q[\\beta])^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}](y-X\\mathbb E_q[\\beta]) - (X\\mathbb E_q[\\beta])^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}]X\\mathbb E_q[\\beta] \\\\ \\mathbb E_q[(y-X\\beta)^{\\mathsf{T}}\\Sigma^{-1}(y-X\\beta)] &= (y-X\\mu_\\beta)^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}](y-X\\mu_\\beta) + \\text{tr}\\left(X^\\mathsf{T}\\mathbb E_q[\\Sigma^{-1}]X\\Sigma_\\beta\\right) \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/01-linear.html","id":"model-coefficients","dir":"Articles > Web_only","previous_headings":"Normal Linear Regression","what":"Model Coefficients","title":"Linear Models","text":"regression coefficients, full conditional \\[ \\begin{aligned} \\ln p(\\beta | y, \\Sigma) &\\simeq -\\frac{1}{2}\\left[(y-X\\beta)^{\\mathsf{T}}\\Sigma^{-1}(y-X\\beta) - \\frac{1}{2}(\\beta-\\mu_0)^{\\mathsf{T}}\\Sigma_0^{-1}(\\beta-\\mu_0)\\right] \\\\ &= -\\frac{1}{2}\\left[\\left(\\beta - M^{-1}m\\right)^{\\mathsf{T}} M\\left(\\beta - M^{-1}m\\right)\\right]\\\\ M &= X^{\\mathsf{T}}\\Sigma^{-1}X + \\Sigma_0^{-1} \\\\ m &= X^{\\mathsf{T}}\\Sigma^{-1}y + \\Sigma_0^{-1}\\mu_0 \\\\ \\implies p(\\beta|y,\\Sigma) &= \\text{Normal}(\\mu_{\\beta|y,\\Sigma}, \\Psi_{\\beta|y,\\Sigma}) \\\\ \\Psi_{\\beta|y,\\Sigma} &= \\left(X^{\\mathsf{T}}\\Sigma^{-1}X + \\Sigma_0^{-1}\\right)^{-1} \\\\ \\mu_{\\beta|y,\\Sigma} &= \\Psi_{\\beta|y,\\Sigma}\\left(X^{\\mathsf{T}}\\Sigma^{-1}y + \\Sigma_0^{-1}\\mu_0\\right). \\end{aligned} \\] , optimal density \\[ \\begin{aligned} \\mathbb E_{q(\\Sigma)}[\\ln p(\\beta|y,\\Sigma)] &\\simeq -\\frac{1}{2}\\left[\\left(\\beta - M_q^{-1}m_q\\right)^{\\mathsf{T}} M_q\\left(\\beta - M_q^{-1}m_q\\right)\\right] \\\\ M_q &= \\mathbb E_{q(\\Sigma)}\\left[\\Sigma^{-1}\\right]X^{\\mathsf{T}} X + \\Sigma_0^{-1} \\\\ m_q &= \\mathbb E_{q(\\Sigma)}\\left[\\Sigma^{-1}\\right] X^{\\mathsf{T}} y + \\Sigma_0^{-1}\\mu_0 \\\\ \\implies q^\\star(\\beta) &= \\text{Normal}(\\mu_{q(\\beta)}, \\Psi_{q(\\beta)}) \\\\ \\Psi_{q(\\beta)} &= \\left(\\mathbb E_{q(\\Sigma)}\\left[\\Sigma^{-1}\\right] X^{\\mathsf{T}} X + \\Sigma_0^{-1}\\right)^{-1} \\\\ \\mu_{q(\\beta)} &= \\Sigma_{q(\\beta)}\\left(\\mathbb E_{q(\\Sigma)}\\left[\\Sigma^{-1}\\right] X^{\\mathsf{T}} y + \\Sigma_0^{-1}\\mu_0\\right). \\end{aligned} \\] exact formulation density depends upon form \\(\\Sigma\\) resulting density \\(q(\\Sigma)\\). Assuming \\(\\Sigma=\\sigma^2 \\), replace \\(q(\\Sigma)\\) \\(q(\\sigma^2)\\).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/01-linear.html","id":"inverse-gamma-prior-on-sigma2","dir":"Articles > Web_only","previous_headings":"Normal Linear Regression","what":"Inverse-Gamma prior on \\(\\sigma^2\\)","title":"Linear Models","text":"variance component assuming \\(\\Sigma=\\sigma^2 \\), \\[ \\begin{aligned} \\ln p(\\sigma^2|y,\\beta) &\\simeq  \\frac{N}{2}\\ln(\\sigma^{2})-\\frac{1}{2}\\sigma^{-2}\\left[(y-X\\beta)^{\\mathsf{T}}(y-X\\beta)\\right] - (a_0+1)\\ln(\\sigma^2) - \\sigma^{-2}b_0\\\\ \\implies p(\\sigma^2|y,\\beta) &= \\text{Inverse-Gamma}(\\sigma^2|a_{\\sigma^2|\\beta,y}, b_{\\sigma^2|\\beta,y}) \\\\ a_{\\sigma^2|\\beta,y} &= a_0 + \\frac{N}{2} \\\\ b_{\\sigma^2|\\beta,y} &= b_0 + \\frac{\\lVert y-X\\beta\\rVert^2}{2} \\end{aligned} \\] , optimal density \\[ \\begin{aligned} q^\\star(\\sigma^2) &\\propto \\mathbb E_{q(\\beta)}\\left[\\ln p(\\sigma^2|y,\\beta)\\right] \\\\ \\implies q^\\star(\\sigma^2) &= \\text{Inverse-Gamma}(a_{q(\\sigma^2)}, b_{q(\\sigma^2)}) \\\\ a_{q(\\sigma^2)} &= a_0 + \\frac{N}{2} \\\\ b_{q(\\sigma^2)} &= b_0 + \\frac{\\lVert y - X\\mu_{q(\\beta)}\\rVert^2+\\text{tr}(X^{\\mathsf{T}} X\\Psi_{q(\\beta)})}{2} \\end{aligned} \\] implying \\[ \\begin{aligned} \\mathbb E_{q(\\sigma^2)}\\left[\\sigma^{-2}\\right] &=   \\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}} \\\\ \\mathbb E_{q(\\sigma^2)}\\left[\\ln(\\sigma^2)\\right] &=   \\ln\\left(b_{q(\\sigma^2)}\\right) -\\psi\\left(a_{q(\\sigma^2)}\\right)  \\\\ \\mathbb H_{q(\\sigma^2)}\\left[\\sigma^2\\right] &=   a_{q(\\sigma^2)} + \\ln b_{q(\\sigma^2)} + \\ln\\Gamma \\left(a_{q(\\sigma^2)}\\right) - (1+a_{q(\\sigma^2)})\\psi\\left(a_{q(\\sigma^2)}\\right) \\end{aligned} \\] variational parameters \\(q^\\star(\\beta)\\). alternative form \\(b_{q(\\sigma^2)}\\) term avoids repeated computation statistics use \\[ \\begin{aligned} \\lVert y - X\\mu_{q(\\beta)}\\rVert^2+\\text{tr}(X^{\\mathsf{T}} X\\Psi_{q(\\beta)}) &= \\\\ y^{\\mathsf{T}}y-2\\mu_{q(\\beta)}^{\\mathsf{T}}X^{\\mathsf{T}}y&+\\text{tr}\\left[(X^{\\mathsf{T}}X)\\left(\\Psi_{q(\\beta)}+\\mu_{q(\\beta)}\\mu_{q(\\beta)}^{\\mathsf{T}}\\right)\\right]. \\end{aligned} \\] updates \\[ \\begin{aligned} a_{q(\\sigma^2)} &\\leftarrow a_0 + N/2 \\\\ \\text{Cycle:} \\\\   \\Psi_{q(\\beta)} &\\leftarrow  \\left(\\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}}X^{\\mathsf{T}} X + \\Sigma_0^{-1}\\right)^{-1} \\\\   \\mu_{q(\\beta)} &\\leftarrow \\Psi_{q(\\beta)}\\left(\\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}} X^{\\mathsf{T}} y + \\Sigma_0^{-1}\\mu_0\\right) \\\\   b_{q(\\sigma^2)} &\\leftarrow b_0 + \\frac{\\lVert y - X\\mu_{q(\\beta)}\\rVert^2+\\text{tr}(X^{\\mathsf{T}} X\\Psi_{q(\\beta)})}{2} \\end{aligned} \\] change \\(\\mathcal{L}(q)\\) specified tolerance level indicating convergence. lower bound \\[ \\begin{aligned} \\mathcal{L}(q) &= \\mathbb E_q[\\ln p(y,\\beta,\\sigma^2) - q(\\beta,\\sigma^2)] \\\\ &= \\mathbb E_q[\\ln p(y|\\beta,\\sigma^2)] + \\mathbb E_q[\\ln p(\\beta)] + \\mathbb E_q[\\ln p(\\sigma^2)] + \\mathbb H_q[\\beta] + \\mathbb H_q[\\sigma^2] \\\\ \\mathbb E_q[\\ln p(y|\\beta,\\sigma^2)] &= \\\\ \\mathbb E_q[\\ln p(\\beta)] &= -\\frac{1}{2}\\left[d\\ln(2\\pi)+\\ln|\\Sigma_0|+(\\mathbb E_q[\\beta]-\\mu_0)^\\mathsf{T}\\Sigma_0^{-1}(\\mathbb E_q[\\beta]-\\mu_0)+\\text{tr}\\left(\\Sigma_0^{-1}\\mathbb V_q[\\beta]\\right)\\right]\\\\ \\mathbb E_q[\\ln p(\\sigma^2)] &= a_0\\ln(b_0)-\\ln\\Gamma(a_0)-(a_0+1)\\mathbb E_q[\\ln\\sigma^2]-b_0\\mathbb E_q[\\sigma^{-2}] \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/01-linear.html","id":"half-t-prior-on-sigma","dir":"Articles > Web_only","previous_headings":"Normal Linear Regression","what":"Half-\\(t\\) prior on \\(\\sigma\\)","title":"Linear Models","text":"(Maestrini Wand 2020) optimal density \\(\\beta\\) unchanged previous section. \\(\\lambda\\), \\[ \\begin{aligned} \\ln p(\\lambda|\\sigma^2) &\\simeq -\\lambda a_0^2 -(1/2+1)\\ln\\lambda -b_0/2\\ln\\lambda -\\lambda\\sigma^2/b_0\\\\ \\implies p(\\lambda|\\sigma^2) &= \\text{Inverse-Gamma}\\left(a_{q(\\lambda)}, b_{q(\\lambda)}\\right) \\\\ a_{\\lambda|\\sigma^2} &=(b_0+1)/2 \\\\ b_{\\lambda|\\sigma^2} &= a_0^{-2}+b_0\\sigma^{-2} \\end{aligned} \\] , optimal density \\[ \\begin{aligned} q^\\star(\\lambda) &\\propto \\exp\\left(\\mathbb E_{q(\\sigma^2)}[\\ln p(\\lambda|\\sigma^2)]\\right) \\\\ \\implies q^\\star(\\lambda) &= \\text{Inverse-Gamma}(a_{q(\\lambda)}, b_{q(\\lambda)}) \\\\ a_{q(\\lambda)} &= (b_0+1)/2\\\\ b_{q(\\lambda)} &= a_0^{-2}+b_0\\mathbb E_{q(\\sigma^2)}[\\sigma^{-2}]. \\end{aligned} \\] \\(\\sigma^2\\), \\[ \\begin{aligned} \\ln p(\\sigma^2|y,\\beta,\\lambda) &\\simeq \\frac{N}{2}\\ln(\\sigma^2) - \\frac{1}{2}\\sigma^{-2}||y-X\\beta||^2 -(b_0/2+1)\\ln(\\sigma^2)-\\sigma^{-2}b_0/\\lambda \\\\ \\implies p(\\sigma^2|y,\\beta,\\lambda) &= \\text{Inverse-Gamma}(a_{\\sigma^2|y,\\beta,\\lambda}, b_{\\sigma^2|y,\\beta,\\lambda}) \\\\ a_{\\sigma^2|y,\\beta,\\lambda} &= (b_0+N)/2 \\\\ b_{\\sigma^2|y,\\beta,\\lambda} &= b_0/\\lambda + \\frac{||y-X\\beta||^2}{2} \\end{aligned} \\] , optimal density \\[ \\begin{aligned} q^\\star(\\sigma^2) &\\propto \\exp\\left(\\mathbb E_{q(\\beta,\\lambda)}[\\ln p(\\sigma^2|y,\\beta,\\lambda)]\\right) \\\\ \\implies q^\\star(\\sigma^2) &= \\text{Inverse-Gamma}(a_{q(\\sigma^2)}, b_{q(\\sigma^2)}) \\\\ a_{q(\\sigma^2)} &= (b_0 + N)/2 \\\\ b_{q(\\sigma^2)} &= b_0\\mathbb E_{q(\\lambda)}[\\lambda^{-1}] + \\frac{||y-X\\mu_{q(\\beta)}||^2+\\text{tr}\\left(X^\\mathsf{T}X\\Psi_{q(\\beta)}\\right)}{2}\\\\ &= b_0\\frac{a_{q(\\lambda)}}{b_{q(\\lambda)}} + \\frac{||y-X\\mu_{q(\\beta)}||^2+\\text{tr}\\left(X^\\mathsf{T}X\\Psi_{q(\\beta)}\\right)}{2}. \\end{aligned} \\] updates \\[ \\begin{aligned} a_{q(\\lambda)} &\\leftarrow (b_0+1)/2 \\\\ a_{q(\\sigma^2)} &\\leftarrow (b_0 + N)/2 \\\\ \\text{Cycle:} \\\\   \\Psi_{q(\\beta)} &\\leftarrow  \\left(\\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}}X^{\\mathsf{T}} X + \\Sigma_0^{-1}\\right)^{-1} \\\\   \\mu_{q(\\beta)} &\\leftarrow \\Psi_{q(\\beta)}\\left(\\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}} X^{\\mathsf{T}} y + \\Sigma_0^{-1}\\mu_0\\right) \\\\   b_{q(\\lambda)} &\\leftarrow a_0^{-2} + b_0 \\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}} \\\\   b_{q(\\sigma^2)} &\\leftarrow b_0\\frac{a_{q(\\lambda)}}{b_{q(\\lambda)}} + \\frac{\\lVert y - X\\mu_{q(\\beta)}\\rVert^2+\\text{tr}(X^{\\mathsf{T}} X\\Psi_{q(\\beta)})}{2} \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/01-linear.html","id":"t-linear-regression","dir":"Articles > Web_only","previous_headings":"","what":"\\(t\\) Linear Regression","title":"Linear Models","text":"(Wand et al. 2010) replace \\(p(y|\\beta,\\sigma^2) = \\text{Normal}(y|X\\beta, \\Sigma)\\) \\[ \\begin{aligned} p(y_i|\\beta,\\sigma,\\nu) &= \\text{Student-t}(x_i^{\\mathsf{T}}\\beta, \\sigma, \\nu) \\\\ p(\\nu) &= \\text{Uniform}(\\nu_0, \\nu_1) \\end{aligned} \\] equivalent \\[ \\begin{aligned} p(y_i|\\beta,\\sigma,\\nu) &= \\text{Normal}(x_i^{\\mathsf{T}}\\beta, \\lambda_i\\sigma^2) \\\\ p(\\lambda_i|\\nu) &= \\text{Inverse-Gamma}(\\nu/2, \\nu/2) \\\\ p(\\nu) &= \\text{Uniform}(\\nu_0, \\nu_1). \\end{aligned} \\] Assuming inverse-gamma prior \\(\\sigma^2\\), full-conditionals satisfy \\[ \\begin{aligned} \\ln p(\\beta|y,\\sigma^2,\\nu,\\lambda) &= \\text{const} \\\\ \\ln p(\\sigma^2|y,\\beta,\\nu,\\lambda) &= \\text{const} -(a_0+n/2)\\ln(\\sigma^2) - \\left[b_0+\\frac{1}{2}\\left((y-X\\beta)^{\\mathsf{T}} \\text{diag}(1/\\lambda)(y - X\\beta)\\right)\\right]/\\sigma^2 \\\\ \\ln p(\\lambda_i|y,\\beta,\\nu,\\sigma^2) &= \\text{const} + \\sum_{=1}^n\\left[ -\\frac{1}{2}(\\nu + 1)\\ln(\\lambda_i) - \\frac{1}{2}\\left[\\nu + \\sigma^{-2}(y_i-x_i^{\\mathsf{T}}\\beta)^2\\right]/\\lambda_i\\right] \\\\ \\ln p(\\nu|y,\\beta,\\sigma^2,\\lambda) &= \\text{const} + n\\left[\\frac{\\nu}{2}\\ln(\\nu/2)-\\ln\\Gamma(\\nu/2)\\right]-(\\nu/2)1^{\\mathsf{T}}(\\ln\\lambda+1/\\lambda),\\quad\\nu_0<\\nu<\\nu_1 \\end{aligned} \\] use factorisation \\(q(\\beta,\\nu,\\sigma^2,\\lambda)=q(\\beta,\\nu)q(\\sigma^2)q(\\lambda)\\) , form full-conditionals , results \\[ \\begin{aligned} q^\\star(\\beta) &= \\text{Normal}(\\mu_{q(\\beta)}, \\Sigma_{q(\\beta)}) \\\\ q^\\star(\\sigma^2) &= \\text{Inverse-Gamma}(a_{q(\\sigma^2)}, b_{q(\\sigma^2)}) \\\\ q^\\star(\\lambda_i) &= \\text{Inverse-Gamma}(a_{q(\\lambda_i)}, b_{q(\\lambda_i)}) \\\\ q^\\star(\\nu) &= \\frac{\\exp\\left\\{n\\left[\\frac{\\nu}{2}\\ln(\\nu/2)-\\ln\\Gamma(\\nu/2)\\right]-(\\nu/2)C_\\nu\\right\\}}{\\mathcal{F}(0,n,C_\\nu,\\nu_0,\\nu_1)} \\\\ C_\\nu &= \\sum_{=1}^n \\mathbb E[\\ln\\lambda_i] + \\mathbb E[\\lambda_i^{-1}] \\\\ &= \\sum_{=1}^n \\ln(b_{q(\\lambda_i)}) - \\psi\\left(\\frac{1}{2}(\\mathbb \\mu_{q(\\nu)}+1)\\right) + \\frac{a_{q(\\lambda_i)}}{b_{q(\\lambda_i)}} \\\\ \\mu_{q(\\nu)} &= \\frac{\\mathcal{F}(1,n,C_\\nu,\\nu_0,\\nu_1)}{\\mathcal{F}(0,n,C_\\nu,\\nu_0,\\nu_1)} \\\\ a_{q(\\lambda_i)} &= \\frac{\\mu_{q(\\nu)} + 1}{2}\\\\ b_{q(\\lambda_i)} &= \\frac{1}{2}\\left[\\mu_{q(\\nu)} + \\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}}\\left\\{(y-X\\mu_{q(\\beta)})_i^2 + (X\\Sigma_{q(\\beta)}X^{\\mathsf{T}})_{ii}\\right\\}\\right] \\\\ D_\\lambda &= \\text{diag}(a_{q(\\lambda_i)}/b_{q(\\lambda_i)}) \\\\ a_{q(\\sigma^2)} &= a_0 + n/2\\\\ b_{q(\\sigma^2)} &= b_0 + \\frac{1}{2}\\left[(y-X\\mu_{q(\\beta)})^{\\mathsf{T}} D_\\lambda(y-X\\mu_{q(\\beta)})+\\text{tr}(\\Sigma_{q(\\beta)}X^{\\mathsf{T}} D_\\lambda X)\\right]\\\\ \\Sigma_{q(\\beta)} &= \\left(\\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}}X^{\\mathsf{T}} D_\\lambda X + \\Sigma_0^{-1}\\right)^{-1}\\\\ \\mu_{q(\\beta)} &= \\Sigma_{q(\\beta)}\\left(\\frac{a_{q(\\sigma^2)}}{b_{q(\\sigma^2)}}X^{\\mathsf{T}} D_\\lambda y + \\Sigma_0^{-1}\\mu_0\\right). \\end{aligned} \\] ELBO \\[ \\begin{aligned} \\mathcal{L}(q) &= \\mathbb E[\\ln p(y,\\beta,\\sigma^2,\\lambda,\\nu) - \\ln q(\\beta,\\sigma^2,\\lambda,\\nu)] \\\\ &= \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/01-linear.html","id":"linear-mixed-models","dir":"Articles > Web_only","previous_headings":"","what":"Linear Mixed Models","title":"Linear Models","text":"Either previous likelihoods may extended hiearchical model \\[ \\begin{aligned} p(y|\\beta,\\sigma^2) &= \\text{Normal}(y|X\\beta + Z\\gamma, \\Sigma) \\\\ p(\\gamma|G) &= \\text{Normal}(\\gamma|0,G). \\end{aligned} \\] specify grouped parameters, \\(\\gamma = (\\gamma_1^{\\mathsf{T}},...,\\gamma_K^{\\mathsf{T}})^{\\mathsf{T}}\\) \\[ \\begin{aligned} Z &= \\underset{N\\times \\sum_k(J_kR_k)}{\\underbrace{\\begin{bmatrix} Z_1 & \\cdots & \\overset{N\\times J_kR_k}{\\overbrace{Z_k}} &\\cdots &Z_K \\end{bmatrix}}} \\\\ \\gamma_k|\\underset{R_k\\times R_k}{\\underbrace{\\Sigma_k}} &\\sim \\text{Normal}\\left(0, I_{J_k} \\otimes \\Sigma_k\\right) \\\\ \\gamma_{kj}|\\Sigma_k &\\sim \\text{Normal}(0, \\Sigma_k),\\quad j=1,...,J_k\\\\ G &= \\bigoplus_{k=1}^K I_{J_k}\\otimes \\Sigma_k \\\\ &= \\text{diag}(I_{J_1}\\otimes \\Sigma_1,...,I_{J_K}\\otimes \\Sigma_K) \\end{aligned} \\] \\(J_k,R_k\\) hint structure \\(\\gamma_k\\), e.g. (restricted ) \\[ Z_k = I_{J_k}\\otimes \\underset{R_k\\times R_k}{\\underbrace{\\tilde Z_k}}. \\] covers combinations different hierarchical terms linear predictor example, \\[ \\begin{aligned} Z &= Z_1 \\\\ &= I_{10}\\otimes 1_3\\\\ \\gamma_1&\\sim N(0, \\tau_1^2I_{10}) \\end{aligned} \\] \\[ \\begin{aligned} Z &= \\begin{bmatrix} Z_1 & Z_2 & Z_3 \\end{bmatrix} \\\\ Z_1 &= I_{3}\\otimes 1_4\\\\ Z_2 &= I_{4} \\otimes \\begin{pmatrix}1&1\\\\1&2\\\\1&3\\end{pmatrix} \\\\ Z_3 &= \\begin{pmatrix} z_{3,1,1}&\\cdots&z_{3,1,6}\\\\ \\vdots &\\ddots &\\vdots \\\\ z_{3,12,1}&\\cdots&z_{3,12,6} \\end{pmatrix}\\\\ \\gamma_1|\\sigma_1^2&\\sim N(0, \\sigma_1^2I_{3}) \\\\ \\gamma_2|\\Sigma_2&\\sim N(0, I_{4} \\otimes\\Sigma_2) \\\\ \\gamma_3|\\sigma_3^2 &\\sim N(0, \\sigma_3^2I_{6}) \\\\ G &= \\text{bdiag}(\\sigma_1^2 I_3. I_4\\otimes\\Sigma_2, \\sigma_3^2 I_6) \\end{aligned} \\] Similarly fixed effects case, can consider priors variance components \\[ \\begin{aligned} \\Sigma_k &\\sim \\text{Inverse-Wishart}(\\xi_k,\\Lambda_k),\\quad \\xi_k>2(R_k-1)\\\\ \\Sigma_k|\\Lambda_k &\\sim \\text{Inverse-Wishart}(\\nu_k+2(R_k-1),\\Lambda_k),\\quad \\nu_k>0 \\\\ \\Lambda_k &\\sim \\text{Inverse-Wishart}\\left(1, \\left[\\nu_k\\text{diag}(a_{k1}^2,...,a_{kR_k}^2)\\right]^{-1}\\right) \\end{aligned} \\] \\(R_k=1\\) \\(\\Sigma_k=\\tau_kI_{J_k}\\) \\[ \\begin{aligned} \\tau_k &\\sim \\text{Inverse-Gamma}(\\xi_k/2,\\xi_k\\lambda_k/2) \\\\ \\tau_k|\\lambda_k&\\sim \\text{Inverse-Gamma}(\\xi_k/2,\\xi_k\\lambda_k/2) \\\\ \\lambda_k &\\sim \\text{Inverse-Gamma}\\left(1/2,a_k^{-2}\\right) \\end{aligned} \\] derivation optimal densities follows linear regression model. Define \\(C = [X \\ Z]\\), \\(\\zeta=(\\beta^\\top \\ \\gamma^\\top)^\\top\\), \\[ \\Xi = \\Sigma_0 \\oplus G \\implies \\Xi^{-1} = \\Sigma_0^{-1}\\oplus G^{-1} \\] \\[ \\begin{aligned} p(\\beta,\\gamma|y,\\Sigma,G) &\\propto p(\\beta,\\gamma|y,\\Sigma,\\Omega_1,...,\\Omega_K) \\\\ &\\propto p(y|\\beta,\\gamma,\\Sigma)p(\\beta)\\prod_{k=1}^Kp(\\gamma_k|\\Omega_k) \\\\ \\ln p(\\beta,\\gamma|) &\\simeq -\\frac{1}{2}\\left[\\zeta^{^{\\mathsf{T}}}(C^\\top\\Sigma^{-1}C+\\Xi^{-1})\\zeta - 2\\zeta^{\\mathsf{T}}C^{\\mathsf{T}}\\Sigma^{-1} y\\right] \\\\ \\zeta|\\text{rest} &\\sim \\text{Normal}(\\mu_{\\zeta|\\text{rest}},\\Sigma_{\\zeta|\\text{rest}}) \\\\ \\Sigma_{\\zeta|\\text{rest}} &= \\left(C^{\\mathsf{T}}\\Sigma^{-1}C + \\Xi^{-1}\\right)^{-1}\\\\ \\mu_{\\zeta|\\text{rest}} &= \\Sigma_{\\zeta|\\text{rest}}\\left(C^{\\mathsf{T}}\\Sigma^{-1}y + \\Xi^{-1}\\begin{bmatrix}\\mu_0\\\\ 0 \\end{bmatrix}\\right). \\end{aligned} \\] , optimal density \\[ \\begin{aligned} q(\\zeta) &= \\text{Normal}(\\zeta|\\mu_\\zeta,\\Sigma_\\zeta) \\\\ \\Sigma_\\zeta &= \\left(C^{\\mathsf{T}}\\mathbb E_q[\\Sigma^{-1}]C + \\mathbb E_q[\\Xi^{-1}]\\right)^{-1} \\\\ \\mu_\\zeta &= \\Sigma_\\zeta \\left(C^{\\mathsf{T}}\\mathbb E_q[\\Sigma^{-1}]y + \\mathbb E_q[\\Xi^{-1}]\\begin{bmatrix}\\mu_0\\\\ 0 \\end{bmatrix}\\right) \\\\ \\mathbb E_q[\\Xi^{-1}] &= \\begin{bmatrix} \\Sigma_0^{-1} & 0 \\\\ 0 & \\bigoplus_{k=1}^K\\left(I_{J_k}\\otimes \\mathbb E[\\Omega_k^{-1}]\\right)\\end{bmatrix} \\end{aligned} \\] Suppose assumed \\(\\Sigma = \\sigma^2 I_N\\) \\(p(\\sigma^2)=\\text{Inv-Gamma}(a_0,b_0)\\), similar \\[ \\begin{aligned} q(\\sigma^2) &= \\text{Inverse-Gamma}(a_{\\sigma^2}, b_{\\sigma}^2) \\\\ a_{\\sigma^2} &= a_0 + \\tfrac{N}{2} \\\\ b_{\\sigma^2} &= b_0 + \\tfrac{1}{2}\\left\\{\\lVert y - C\\mu_{q(\\zeta)}\\rVert^2+\\text{tr}(C^{\\mathsf{T}} C\\Sigma_{q(\\zeta)})\\right\\}. \\end{aligned} \\] new variational densities \\(\\Omega_k\\). Consider just one \\(\\Omega_k\\) \\(\\gamma_i | \\Omega \\sim N(0, \\Omega), =1,...,m\\) (.e. standard random effects model) \\(\\Omega \\sim \\text{Inverse-Wishart}(\\xi_0, \\Lambda_0)\\) \\[ \\begin{aligned} p(\\Omega|\\text{rest}) &\\propto p(\\Omega|\\gamma) \\\\ &\\propto p(\\gamma|\\Omega)p(\\Omega) \\\\ \\ln p(\\Omega|\\gamma) &\\simeq -\\frac{m}{2} \\ln |\\Omega| - \\frac{1}{2}\\sum_{=1}^m\\gamma_i^\\mathsf{T}\\Omega^{-1}\\gamma_i - (\\xi_0 + p + 1)/2\\ln|\\Omega| - \\text{tr}(\\Lambda_0\\Omega^{-1}) \\\\ \\mathbb {E}_q[\\ln p(\\Omega|\\gamma)] &\\simeq - \\frac{1}{2}(\\xi_0 + p + 1 + m)\\ln|\\Omega| - \\frac{1}{2}\\sum_{=1}^m \\mathbb{E}_q[\\gamma_i^\\mathsf{T}\\Omega^{-1}\\gamma_i] - \\text{tr}(\\Lambda_0\\Omega^{-1}) \\end{aligned} \\] Note \\[ \\begin{aligned} \\mathbb{E}_q[\\gamma_i^\\mathsf{T}\\Omega^{-1}\\gamma_i] &= (\\mathbb{E}_q[\\gamma_i])^\\mathsf{T}\\Omega^{-1}\\mathbb{E}_q[\\gamma_i] + \\text{tr}(\\mathbb{V}_q[\\gamma_i]\\Omega^{-1}) \\\\ &= \\text{tr}\\left(\\mathbb{E}_q[\\gamma_i](\\mathbb{E}_q[\\gamma_i])^\\mathsf{T}\\Omega^{-1} + \\mathbb{V}_q[\\gamma_i]\\Omega^{-1}\\right) \\\\ &= \\text{tr}\\left(\\left(\\mathbb{E}_q[\\gamma_i](\\mathbb{E}_q[\\gamma_i])^\\mathsf{T} + \\mathbb{V}_q[\\gamma_i]\\right)\\Omega^{-1}\\right) \\end{aligned} \\] optimal density also Inverse-Wishart, .e. \\[ q(\\Omega) = \\text{Inverse-Wishart}(\\Omega| \\xi_{q(\\Omega)}, \\Lambda_{q(\\Omega)}) \\] \\[ \\begin{aligned} \\xi_{q(\\Omega)} &= \\xi_0 + m \\\\ \\Lambda_{q(\\Omega)} &= \\Lambda_0 + \\sum_{=1}^m \\left(\\mathbb{E}_q[\\gamma_i](\\mathbb{E}_q[\\gamma_i])^\\mathsf{T} + \\mathbb{V}_q[\\gamma_i]\\right) \\end{aligned} \\] required expectations \\[ \\begin{aligned} \\mathbb{E}_q[\\Omega^{-1}] &= \\xi_{q(\\Omega)}\\Lambda_{q(\\Omega)}^{-1} \\\\ \\mathbb{E}_q[\\ln|\\Omega|] &= \\ln|\\Lambda_{q(\\Omega)}/2| - \\psi_d(\\xi_{q(\\Omega)} - d + 1) \\end{aligned} \\]","code":""},{"path":[]},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/01-linear.html","id":"notation","dir":"Articles > Web_only","previous_headings":"","what":"Notation","title":"Linear Models","text":"symbol \\(\\simeq\\) used indicate equality additive constant, similar \\(\\propto\\) multiplicative constants.","code":""},{"path":[]},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"introduction","dir":"Articles > Web_only","previous_headings":"","what":"Introduction","title":"Distributions","text":"document provides reference relevant terms useful distributions relationships context variational inference.","code":""},{"path":[]},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"gamma","dir":"Articles > Web_only","previous_headings":"Gamma and Inverse-Gamma","what":"Gamma","title":"Distributions","text":"\\[ \\begin{aligned} y &\\sim \\text{Gamma}(\\alpha, \\beta) \\\\ f(y|\\alpha,\\beta) &= \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)}e^{-y\\beta}y^{\\alpha-1},\\quad y,\\alpha,\\beta\\\\mathbb R^+ \\\\ \\ln f(y|\\alpha,\\beta) &= \\alpha\\ln\\beta-\\ln\\Gamma(\\alpha)-y\\beta+(\\alpha-1)\\ln y\\\\ \\mathbb E[y] &= \\alpha\\beta \\\\ \\mathbb V[y] &= \\alpha\\beta^2 \\\\ \\mathbb H[y] &= \\alpha-\\ln\\beta+\\ln\\Gamma()+(1-\\alpha)\\psi(\\alpha) \\\\ \\mathbb E[\\ln y] &= \\psi(\\alpha)-\\ln(\\beta) \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"inverse-gamma","dir":"Articles > Web_only","previous_headings":"Gamma and Inverse-Gamma","what":"Inverse-Gamma","title":"Distributions","text":"\\(y^{-1}\\sim\\text{Inverse-Gamma}(\\alpha,\\beta)\\). \\[ \\begin{aligned} y &\\sim \\text{Inverse-Gamma}(\\alpha,\\beta) \\\\ f(y|\\alpha,\\beta) &= \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)}e^{-y/\\beta}y^{-\\alpha-1},\\quad y,\\alpha,\\beta\\\\mathbb R^+ \\\\ \\ln f(y|\\alpha,\\beta) &= \\alpha\\ln\\beta-\\ln\\Gamma(\\alpha)-y/\\beta-(\\alpha+1)\\ln(y) \\\\ \\mathbb E[y] &= \\frac{\\beta}{\\alpha-1},\\quad \\alpha>1 \\\\ \\mathbb E[y^{-1}] &= \\frac{\\alpha}{\\beta} \\\\ \\mathbb V[y] &= \\frac{\\beta^2}{(\\alpha-1)^2(\\alpha-2)},\\quad \\alpha>2 \\\\ \\mathbb H[y] &= \\alpha+\\ln\\beta+\\ln\\Gamma()-(1+\\alpha)\\psi(\\alpha) \\\\ \\mathbb E[\\ln y] &= \\ln\\beta-\\psi(\\alpha) \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"relations","dir":"Articles > Web_only","previous_headings":"Gamma and Inverse-Gamma","what":"Relations","title":"Distributions","text":"\\[ \\begin{align} Y &\\sim \\text{Gamma}(\\alpha,\\beta) &\\iff Y &\\sim \\text{Inv-Gamma}(\\alpha, \\beta) \\\\ Y &\\sim \\text{Gamma}(\\nu/2,1/2) &\\iff Y &\\sim \\text{Chi-square}(\\nu)\\\\ Y &\\sim \\text{Inv-Gamma}(\\alpha,1/2) &\\iff Y &\\sim \\text{Inv-Chi-square}(2\\alpha) \\\\ Y &\\sim \\text{Inv-Gamma}(\\alpha, \\beta) &\\iff Y&\\sim \\text{Inv-Wishart}(2\\alpha,2\\beta) \\end{align} \\] \\[ \\begin{aligned} Y^2|X&\\sim\\text{Inv-Gamma}(\\nu/2,\\nu/X)\\\\ X&\\sim\\text{Inv-Gamma}(1/2,1/^2) \\\\ \\implies Y&\\sim\\text{Half-}t(\\nu,) \\\\ Y^2|X&\\sim\\text{Inv-Gamma}(1/2,1/X)\\\\ X&\\sim\\text{Inv-Gamma}(1/2,1/^2) \\\\ \\implies Y&\\sim\\text{Half-Cauchy}() \\end{aligned} \\]","code":""},{"path":[]},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"chi-squared","dir":"Articles > Web_only","previous_headings":"Chi-squared, Inverse-Chi-squared, and Scaled-Chi-squared","what":"Chi-squared","title":"Distributions","text":"\\[ \\begin{aligned} y &\\sim \\text{Chi-squared}(\\nu) \\\\ f(y|\\nu) &= \\frac{1}{2^{n/2}\\Gamma(n/2)}e^{-\\nu/2}y^{n/2-1},\\quad y,\\nu\\\\mathbb R^+ \\\\ \\ln f(y|\\nu) &= -(n/2)\\ln(2)-\\ln\\Gamma(n/2)-\\nu/2+(n/2-1)\\ln(y)\\\\ \\mathbb E[y] &= \\nu \\\\ \\mathbb V[y] &= 2\\nu \\\\ \\mathbb H[y] &= \\psi(n/2) + \\ln(2) \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"inverse-chi-squared","dir":"Articles > Web_only","previous_headings":"Chi-squared, Inverse-Chi-squared, and Scaled-Chi-squared","what":"Inverse-Chi-squared","title":"Distributions","text":"\\[ \\begin{aligned} y &\\sim \\text{Inverse-Chi-squared}(\\nu) \\\\ f(y|\\nu) &= \\frac{2^{-\\nu/2}}{\\Gamma(\\nu/2)}y^{-\\nu/2-1}e^{-1/(2y)},\\quad y,\\nu\\\\mathbb R^{+} \\\\ \\ln f(y|\\nu) &= -(\\nu/2)\\ln(2)-\\ln\\Gamma(\\nu/2)-(\\nu/2+1)\\ln(y)-1/(2y) \\\\ \\mathbb E[y] &= \\frac{1}{\\nu-2},\\quad\\nu>2\\\\ \\mathbb V[y] &= \\frac{2}{(\\nu-2)^2(\\nu-4)},\\quad \\nu>4 \\\\ \\mathbb H[y] &= \\nu/2+\\ln\\left(\\frac{\\nu}{2}\\Gamma(\\nu/2)\\right)-(\\nu/2+1)\\psi(\\nu/2) \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"scale-inverse-chi-squared","dir":"Articles > Web_only","previous_headings":"Chi-squared, Inverse-Chi-squared, and Scaled-Chi-squared","what":"Scale-inverse-Chi-squared","title":"Distributions","text":"\\[ \\begin{aligned} y &\\sim \\text{Scaled-inverse-Chi-squared}(\\nu,\\tau^2) \\\\ f(y|\\nu,\\tau^2) &= \\frac{(\\tau^2\\nu/2)^{\\nu/2}}{\\Gamma(\\nu/2)} \\frac{\\exp\\left(\\frac{-\\nu\\tau^2}{2y}\\right)}{y^{1+\\nu/2}} \\\\ \\ln f(y,\\tau^2) &= (\\nu/2)\\ln(\\nu\\tau^2/2)-\\ln\\Gamma(\\nu/2)-\\frac{\\nu\\tau^2}{2y}-(1+\\nu/2)\\ln(y) \\\\ \\mathbb E[y] &= \\frac{\\nu\\tau^2}{\\nu-2},\\quad \\nu>2\\\\ \\mathbb V[y] &= \\frac{2\\nu^2\\tau^4}{(\\nu-2)^2(\\nu-4)},\\quad \\nu>4\\\\ \\mathbb H[y] &= \\nu/2+\\ln\\left(\\frac{\\nu\\tau^2}{2}\\Gamma(\\nu/2)\\right)-(1+\\nu/2)\\psi(\\nu/2) \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"relations-1","dir":"Articles > Web_only","previous_headings":"Chi-squared, Inverse-Chi-squared, and Scaled-Chi-squared","what":"Relations","title":"Distributions","text":"\\[ \\begin{aligned} \\text{Chi-square}(\\nu) &\\sim \\text{Gamma}(\\nu/2,2) \\\\ \\text{Inverse-Chi-Squared}(\\nu) &\\sim \\text{Scale-Inverse-Chi-Squared}(\\nu,1/\\nu) \\\\ \\text{Scale-Inverse-Chi-Squared}(\\nu,\\tau^2) &\\sim \\text{Inverse-Gamma}(\\nu/2,\\nu\\tau^2/2) \\end{aligned} \\]","code":""},{"path":[]},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"wishart","dir":"Articles > Web_only","previous_headings":"Wishart, Inverse-Wishart, G-Wishart","what":"Wishart","title":"Distributions","text":"\\[ \\begin{aligned} \\Sigma &\\sim \\text{Wishart}_d(\\xi,\\Sigma) \\\\ f(\\Sigma|\\xi,\\lambda) &= \\frac{1}{2^{\\xi d/2}|\\Lambda|^{\\xi/2}\\Gamma_d(\\xi/2)}|\\Sigma|^{(\\xi-d-1)/2}e^{-\\text{tr}(\\Lambda^{-1}\\Sigma)/2},\\quad \\xi>d-1,\\Lambda>0 \\\\ \\ln f(\\Sigma|\\xi,\\lambda) &= -(\\xi d/2)-(\\xi/2)\\ln|\\Lambda|-\\ln\\Gamma_d(\\xi/2)+(\\xi-d-1)/2\\ln|\\Sigma|-\\text{tr}(\\Lambda^{-1}\\Sigma)/2\\\\ \\mathbb E[\\Sigma] &= \\xi\\Lambda \\\\ \\mathbb V[\\Sigma]_{ij} &= \\\\ \\mathbb H[\\Sigma] &= \\frac{d+1}{2}\\ln|\\Lambda|+\\frac{d(d+1)}{2}\\ln(2)+\\ln\\Gamma_d(\\xi/2)-\\frac{\\xi-d-1}{2}\\psi_d(\\xi/2)+\\frac{\\xi d}{2} \\\\ \\mathbb E[\\ln|\\Sigma|] &= \\psi_d(\\xi/2)+d\\ln(2)+\\ln|\\Lambda| \\\\ \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"inverse-wishart","dir":"Articles > Web_only","previous_headings":"Wishart, Inverse-Wishart, G-Wishart","what":"Inverse-Wishart","title":"Distributions","text":"\\(\\Sigma\\sim\\text{Wishart}_d(\\xi,\\Lambda)\\) \\(\\Sigma^{-1}\\sim\\text{Inverse-Wishart}_d(\\xi,\\Lambda^{-1})\\) \\[ \\begin{aligned} \\Sigma &\\sim \\text{Inverse-Wishart}_d(\\xi,\\Sigma) \\\\ f(\\Sigma|\\xi,\\Lambda) &= \\frac{|\\Lambda|^{\\xi/2}}{2^{\\xi d/2}\\Gamma_d(\\xi/2)}|\\Sigma|^{-(\\xi+d+1)/2}e^{-\\text{tr}(\\Lambda\\Sigma^{-1})/2},\\quad \\xi>d-1,\\Lambda>0 \\\\ \\ln f(\\Sigma|\\xi,\\Lambda) &= \\xi/2\\ln|\\Lambda|-(\\xi d)/2\\ln(2)-\\ln\\Gamma_d(\\xi/2)-(\\xi+d+1)/2\\ln|\\Sigma|-\\text{tr}(\\Lambda\\Sigma^{-1})\\\\ \\mathbb E[\\Sigma] &= \\frac{\\Lambda}{\\xi-d-1} \\\\ \\mathbb E[\\Sigma^{-1}] &= \\xi\\Lambda^{-1} \\\\ \\mathbb V[\\Sigma]_{ij} &= \\frac{(\\xi-d+1)\\lambda_{ij}^2+(\\xi-d-1)\\lambda_{ii}\\lambda_{jj}}{(\\xi-d)(\\xi-d-1)^2(\\xi-d-3)} \\\\ \\mathbb H[\\Sigma] &= -\\frac{\\xi}{2}\\ln|\\Lambda|+(\\xi+d+1)\\mathbb E[\\ln|\\Sigma|]+\\frac{\\xi d}{2}\\ln(2) +\\ln\\Gamma_d(\\xi/2) + \\frac{\\xi d}{2}\\\\ \\mathbb E[\\ln|\\Sigma|] &= \\ln|\\tfrac{1}{2}\\Lambda|-\\psi_d(\\xi-d+1) \\end{aligned} \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"relations-2","dir":"Articles > Web_only","previous_headings":"Wishart, Inverse-Wishart, G-Wishart","what":"Relations","title":"Distributions","text":"\\[ \\begin{aligned} \\text{Wishart}_1(\\xi,\\Lambda) &\\sim \\text{Gamma}(\\xi/2,\\Lambda/2) \\\\ \\text{inv-Wishart}_1(\\xi,\\Lambda) &\\sim \\text{Inv-Gamma}(\\xi/2,\\Lambda/2) \\end{aligned} \\] \\[ \\begin{aligned} \\Sigma|X_1,...,X_p&\\sim\\text{Inv-Wishart}_p(\\nu+p-1,2\\nu\\text{diag}(1/X_1,...,1/X_p))\\\\ X_j&\\overset{\\text{ind}}{\\sim}\\text{Inv-Gamma}(1/2,1/A_j^2) \\\\ \\implies \\sigma_{j}&\\sim\\text{Half-}t(\\nu,A_j) \\\\ \\rho_{ij} &\\propto (1-\\rho_{ij}^2)^{\\nu/2-1} \\end{aligned} \\] \\(\\Sigma_{ij} = \\rho_{ij}\\sigma_i\\sigma_j\\)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/articles/web_only/99-distributions.html","id":"identities-and-definitions","dir":"Articles > Web_only","previous_headings":"","what":"Identities and Definitions","title":"Distributions","text":"\\[ \\begin{aligned} \\Gamma_d(x) &= \\text{multivariate gamma function}(x) \\\\ &= \\pi^{d(d-1)/4}\\prod_{j=1}^d \\Gamma\\left[x+(1-j)/2\\right]\\\\ \\psi_d(x) &= \\text{multivariate digamma function}(x) \\\\ &= \\sum_{j=1}^d \\psi\\left[x+(1-j)/2\\right] \\end{aligned} \\] \\[ \\left(\\text{bdiag}(A_1,...,A_p)\\right)^{-1}=\\text{bdiag}(A_1^{-1},...,A_p^{-1}) \\] \\[ \\mathbb E[\\text{tr}(AX)] = \\text{tr}(\\mathbb E[X]) \\]","code":""},{"path":"https://jatotterdell.github.io/varapproxr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"James Totterdell. Author, maintainer.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Totterdell J (2023). varapproxr: Variational approximations. R package version 0.0.0.9000, https://jatotterdell.github.io/varapproxr/.","code":"@Manual{,   title = {varapproxr: Variational approximations},   author = {James Totterdell},   year = {2023},   note = {R package version 0.0.0.9000},   url = {https://jatotterdell.github.io/varapproxr/}, }"},{"path":"https://jatotterdell.github.io/varapproxr/index.html","id":"varapproxr","dir":"","previous_headings":"","what":"Variational approximations","title":"Variational approximations","text":"work progress repository implementations variational approximate inference. implementations currently prototypes; accuracy efficiency guaranteed.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Variational approximations","text":"","code":"# install.packages(\"devtools\") devtools::install_github('jatotterdell/varapproxr')"},{"path":"https://jatotterdell.github.io/varapproxr/index.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"Variational approximations","text":"varapproxr uses: GCEM calculation special mathematics functions. StatsLib functions probability distributions.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ExpectationGaussianSufficientStatistics.html","id":null,"dir":"Reference","previous_headings":"","what":"Gaussian transform natural parameters to E[T(X)] parameters. — ExpectationGaussianSufficientStatistics","title":"Gaussian transform natural parameters to E[T(X)] parameters. — ExpectationGaussianSufficientStatistics","text":"Gaussian transform natural parameters E[T(X)] parameters.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ExpectationGaussianSufficientStatistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gaussian transform natural parameters to E[T(X)] parameters. — ExpectationGaussianSufficientStatistics","text":"","code":"ExpectationGaussianSufficientStatistics(eta)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/ExpectationGaussianSufficientStatistics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gaussian transform natural parameters to E[T(X)] parameters. — ExpectationGaussianSufficientStatistics","text":"eta natural parameter vector.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ExpectationInverseGWishartSufficientStatistics.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse-G-Wishart transform natural parameters to E[T(X)] parameters. — ExpectationInverseGWishartSufficientStatistics","title":"Inverse-G-Wishart transform natural parameters to E[T(X)] parameters. — ExpectationInverseGWishartSufficientStatistics","text":"Inverse-G-Wishart transform natural parameters E[T(X)] parameters.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ExpectationInverseGWishartSufficientStatistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse-G-Wishart transform natural parameters to E[T(X)] parameters. — ExpectationInverseGWishartSufficientStatistics","text":"","code":"ExpectationInverseGWishartSufficientStatistics(G, eta)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/ExpectationInverseGWishartSufficientStatistics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse-G-Wishart transform natural parameters to E[T(X)] parameters. — ExpectationInverseGWishartSufficientStatistics","text":"G graph. eta natural parameter vector.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/G_VMP.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate — G_VMP","title":"Calculate — G_VMP","text":"Calculate","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/G_VMP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate — G_VMP","text":"","code":"G_VMP(v, Q, r, s)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/G_VMP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate — G_VMP","text":"v (d + d*d) x 1 vector Q d x d matrix r d x 1 vector s double","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianCommonParameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Gaussian transform natural parameters to E[T(X)] parameters. — GaussianCommonParameters","title":"Gaussian transform natural parameters to E[T(X)] parameters. — GaussianCommonParameters","text":"Gaussian transform natural parameters E[T(X)] parameters.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianCommonParameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gaussian transform natural parameters to E[T(X)] parameters. — GaussianCommonParameters","text":"","code":"GaussianCommonParameters(eta)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianCommonParameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gaussian transform natural parameters to E[T(X)] parameters. — GaussianCommonParameters","text":"eta natural parameter vector.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianEntropy.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate entropy for Gaussian density — GaussianEntropy","title":"Calculate entropy for Gaussian density — GaussianEntropy","text":"Calculate entropy Gaussian density","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianEntropy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate entropy for Gaussian density — GaussianEntropy","text":"","code":"GaussianEntropy(eta)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianEntropy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate entropy for Gaussian density — GaussianEntropy","text":"eta Natural parameter","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianLikelihoodFragment.html","id":null,"dir":"Reference","previous_headings":"","what":"Gaussian likelihood fragment update — GaussianLikelihoodFragment","title":"Gaussian likelihood fragment update — GaussianLikelihoodFragment","text":"Gaussian likelihood fragment update","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianLikelihoodFragment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gaussian likelihood fragment update — GaussianLikelihoodFragment","text":"","code":"GaussianLikelihoodFragment(n, XtX, Xty, yty, eta1_in, eta2_in)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianLikelihoodFragment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gaussian likelihood fragment update — GaussianLikelihoodFragment","text":"n Number rows XtX Statistic 1 Xty Statistic 2 yty Statistic 3 eta1_in Natural parameter 1 eta2_in Natural parameter 2","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianPriorFragment.html","id":null,"dir":"Reference","previous_headings":"","what":"Gaussian prior fragment update — GaussianPriorFragment","title":"Gaussian prior fragment update — GaussianPriorFragment","text":"Gaussian prior fragment update","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianPriorFragment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gaussian prior fragment update — GaussianPriorFragment","text":"","code":"GaussianPriorFragment(mu, Sigma)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/GaussianPriorFragment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gaussian prior fragment update — GaussianPriorFragment","text":"mu prior mean Sigma prior variance","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGWishartCommonParameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse-G-Wishart Common parameters — InverseGWishartCommonParameters","title":"Inverse-G-Wishart Common parameters — InverseGWishartCommonParameters","text":"Inverse-G-Wishart Common parameters","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGWishartCommonParameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse-G-Wishart Common parameters — InverseGWishartCommonParameters","text":"","code":"InverseGWishartCommonParameters(eta)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGWishartCommonParameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse-G-Wishart Common parameters — InverseGWishartCommonParameters","text":"eta natural parameter vector.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGWishartPriorFragment.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse G-Wishart prior fragment update — InverseGWishartPriorFragment","title":"Inverse G-Wishart prior fragment update — InverseGWishartPriorFragment","text":"Inverse G-Wishart prior fragment update","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGWishartPriorFragment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse G-Wishart prior fragment update — InverseGWishartPriorFragment","text":"","code":"InverseGWishartPriorFragment(G, xi, Lambda)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGWishartPriorFragment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse G-Wishart prior fragment update — InverseGWishartPriorFragment","text":"G graph matrix xi prior shape Lambda prior symmetric positive definite matrix","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGammaPriorFragment.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse-Gamma prior fragment update — InverseGammaPriorFragment","title":"Inverse-Gamma prior fragment update — InverseGammaPriorFragment","text":"Inverse-Gamma prior fragment update","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGammaPriorFragment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse-Gamma prior fragment update — InverseGammaPriorFragment","text":"","code":"InverseGammaPriorFragment(a, b)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseGammaPriorFragment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse-Gamma prior fragment update — InverseGammaPriorFragment","text":"Shape parameter b Scale parameter","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseWishartPriorFragment.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Wishart prior fragment update — InverseWishartPriorFragment","title":"Inverse Wishart prior fragment update — InverseWishartPriorFragment","text":"Inverse Wishart prior fragment update","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseWishartPriorFragment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Wishart prior fragment update — InverseWishartPriorFragment","text":"","code":"InverseWishartPriorFragment(xi, Lambda)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/InverseWishartPriorFragment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Wishart prior fragment update — InverseWishartPriorFragment","text":"xi prior shape Lambda prior symmetric positive definite matrix","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/IteratedInverseGWishartFragment.html","id":null,"dir":"Reference","previous_headings":"","what":"Iterated Inverse G-Wishart fragment update — IteratedInverseGWishartFragment","title":"Iterated Inverse G-Wishart fragment update — IteratedInverseGWishartFragment","text":"Iterated Inverse G-Wishart fragment update","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/IteratedInverseGWishartFragment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iterated Inverse G-Wishart fragment update — IteratedInverseGWishartFragment","text":"","code":"IteratedInverseGWishartFragment(G, xi, eta1_in, eta2_in)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/IteratedInverseGWishartFragment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iterated Inverse G-Wishart fragment update — IteratedInverseGWishartFragment","text":"G graph matrix. xi prior shape. eta1_in d + 1 x 1 vector. eta2_in d + 1 x 1 vector.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/arma2vec.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert arma::vec to Rcpp::NumericVector — arma2vec","title":"Convert arma::vec to Rcpp::NumericVector — arma2vec","text":"Convert arma::vec Rcpp::NumericVector","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/arma2vec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert arma::vec to Rcpp::NumericVector — arma2vec","text":"","code":"arma2vec(x)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/arma2vec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert arma::vec to Rcpp::NumericVector — arma2vec","text":"x vector","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/bind_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Right-bind columns of matrices from in list. — bind_cols","title":"Right-bind columns of matrices from in list. — bind_cols","text":"Right-bind columns matrices list.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/bind_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Right-bind columns of matrices from in list. — bind_cols","text":"","code":"bind_cols(x)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/bind_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Right-bind columns of matrices from in list. — bind_cols","text":"x list matrices","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/blockDiag.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct block-diagonal matrix from list of matrices — blockDiag","title":"Construct block-diagonal matrix from list of matrices — blockDiag","text":"Constructs dense block-diagonal matrix list (field) matrices.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/blockDiag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct block-diagonal matrix from list of matrices — blockDiag","text":"","code":"blockDiag(x)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/blockDiag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct block-diagonal matrix from list of matrices — blockDiag","text":"x list matrices","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/check.mfvb.x.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the `x` input to an mfvb regression function — check.mfvb.x","title":"Check the `x` input to an mfvb regression function — check.mfvb.x","text":"Check `x` input mfvb regression function","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/check.mfvb.x.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the `x` input to an mfvb regression function — check.mfvb.x","text":"","code":"check.mfvb.x(x)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/check.mfvb.x.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the `x` input to an mfvb regression function — check.mfvb.x","text":"x x input check","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/check.mfvb.x.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the `x` input to an mfvb regression function — check.mfvb.x","text":"x checks pass","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/check.mfvb.y.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the `y` input to an mfvb regression function — check.mfvb.y","title":"Check the `y` input to an mfvb regression function — check.mfvb.y","text":"Check `y` input mfvb regression function","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/check.mfvb.y.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the `y` input to an mfvb regression function — check.mfvb.y","text":"","code":"check.mfvb.y(x, y)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/check.mfvb.y.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the `y` input to an mfvb regression function — check.mfvb.y","text":"x x input y y input check","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/check.mfvb.y.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the `y` input to an mfvb regression function — check.mfvb.y","text":"x checks pass","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/coef.mfvb.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract model coefficients posterior means — coef.mfvb","title":"Extract model coefficients posterior means — coef.mfvb","text":"`coef.mfvb` implements `coef` generic objects class `mfvb`.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/coef.mfvb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract model coefficients posterior means — coef.mfvb","text":"","code":"# S3 method for mfvb coef(object, ...)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/coef.mfvb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract model coefficients posterior means — coef.mfvb","text":"object `mfvb` model ... Unused","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/confint.mfvb.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute credible intervals for parameters of `mfvb` — confint.mfvb","title":"Compute credible intervals for parameters of `mfvb` — confint.mfvb","text":"Compute credible intervals parameters `mfvb`","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/confint.mfvb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute credible intervals for parameters of `mfvb` — confint.mfvb","text":"","code":"# S3 method for mfvb confint(object, level = 0.95)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/confint.mfvb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute credible intervals for parameters of `mfvb` — confint.mfvb","text":"object `mfvb` model level credible interval level","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/dnorm_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate standard normal density for matrix of variates — dnorm_mat","title":"Evaluate standard normal density for matrix of variates — dnorm_mat","text":"Evaluate standard normal density matrix variates","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/dnorm_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate standard normal density for matrix of variates — dnorm_mat","text":"","code":"dnorm_mat(m)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/dnorm_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate standard normal density for matrix of variates — dnorm_mat","text":"m matrix variates","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/dot_y_minus_Xb.html","id":null,"dir":"Reference","previous_headings":"","what":"E[||y - Xb||^2] — dot_y_minus_Xb","title":"E[||y - Xb||^2] — dot_y_minus_Xb","text":"Calculate E[||y - Xb||^2] b ~ MVN(mu, Sigma)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/dot_y_minus_Xb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"E[||y - Xb||^2] — dot_y_minus_Xb","text":"","code":"dot_y_minus_Xb(yty, Xty, XtX, mu, Sigma)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/dot_y_minus_Xb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"E[||y - Xb||^2] — dot_y_minus_Xb","text":"yty Statistic y'y Xty Statistic X'y XtX Statistic X'X mu Variational mean mu Sigma Variational variance Sigma","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Gamma E[x] — ig_E","title":"Inverse Gamma E[x] — ig_E","text":"Calculate return expected value x ~ IG(,b).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Gamma E[x] — ig_E","text":"","code":"ig_E(a, b)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Gamma E[x] — ig_E","text":"shape b scale","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_inv.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Gamma E[1/x] — ig_E_inv","title":"Inverse Gamma E[1/x] — ig_E_inv","text":"Calculate return E[1/x] x ~ IG(,b).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_inv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Gamma E[1/x] — ig_E_inv","text":"","code":"ig_E_inv(a, b)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_inv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Gamma E[1/x] — ig_E_inv","text":"shape b scale","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_log.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Gamma E[log(x)] — ig_E_log","title":"Inverse Gamma E[log(x)] — ig_E_log","text":"Calculate return E[log(x)] x ~ IG(,b).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Gamma E[log(x)] — ig_E_log","text":"","code":"ig_E_log(a, b)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Gamma E[log(x)] — ig_E_log","text":"shape b scale","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_lpdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate E_q[ln p(x)] where q(x) = IG(x | a, b) and p(x) = IG(x | a0, b0) — ig_E_lpdf","title":"Calculate E_q[ln p(x)] where q(x) = IG(x | a, b) and p(x) = IG(x | a0, b0) — ig_E_lpdf","text":"E_q[ln p(x)] x ~ IG(a0, b0) q(x) = IG(x | , b)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_lpdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate E_q[ln p(x)] where q(x) = IG(x | a, b) and p(x) = IG(x | a0, b0) — ig_E_lpdf","text":"","code":"ig_E_lpdf(a0, b0, a, b)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_E_lpdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate E_q[ln p(x)] where q(x) = IG(x | a, b) and p(x) = IG(x | a0, b0) — ig_E_lpdf","text":"a0 Inverse gamma prior parameter b0 Inverse gamma prior parameter Inverse gamma variational parameter b Inverse gamma variational parameter","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_entropy.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Gamma H[x] — ig_entropy","title":"Inverse Gamma H[x] — ig_entropy","text":"Calculate H[x] x ~ IG(,b)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_entropy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Gamma H[x] — ig_entropy","text":"","code":"ig_entropy(a, b)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/ig_entropy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Gamma H[x] — ig_entropy","text":"shape b scale","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_vech.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate inverse of vech for a vector — inv_vech","title":"Calculate inverse of vech for a vector — inv_vech","text":"Calculate inverse vech vector","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_vech.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate inverse of vech for a vector — inv_vech","text":"","code":"inv_vech(v)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_vech.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate inverse of vech for a vector — inv_vech","text":"v vector dimension d(d+1)/2 lower triangular elements","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_vectorise.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate vec^(-1) — inv_vectorise","title":"Calculate vec^(-1) — inv_vectorise","text":"Calculate vec^(-1)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_vectorise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate vec^(-1) — inv_vectorise","text":"","code":"inv_vectorise(v)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_vectorise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate vec^(-1) — inv_vectorise","text":"v vector dimension d^2 1","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_wishart_E_invX.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Wishart E[X^-1] — inv_wishart_E_invX","title":"Inverse Wishart E[X^-1] — inv_wishart_E_invX","text":"Calculate E[X^-1] X ~ Inverse-Wishart(nu, S).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_wishart_E_invX.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Wishart E[X^-1] — inv_wishart_E_invX","text":"","code":"inv_wishart_E_invX(nu, S)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_wishart_E_invX.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Wishart E[X^-1] — inv_wishart_E_invX","text":"nu Degrees freedom S Scale matrix","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_wishart_E_logdet.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Wishart E[log|X|] — inv_wishart_E_logdet","title":"Inverse Wishart E[log|X|] — inv_wishart_E_logdet","text":"Calculate E[log|X|] X ~ Inverse-Wishart(nu, S).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_wishart_E_logdet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Wishart E[log|X|] — inv_wishart_E_logdet","text":"","code":"inv_wishart_E_logdet(nu, S)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/inv_wishart_E_logdet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Wishart E[log|X|] — inv_wishart_E_logdet","text":"nu Degrees freedom S Scale matrix","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/jaakkola_jordan.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Jaakkola-Jordan update of variational parameters — jaakkola_jordan","title":"Perform Jaakkola-Jordan update of variational parameters — jaakkola_jordan","text":"Perform Jaakkola-Jordan update variational parameters","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/jaakkola_jordan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Jaakkola-Jordan update of variational parameters — jaakkola_jordan","text":"","code":"jaakkola_jordan(X, y, eta1, eta2, eta1_p, eta2_p)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/jaakkola_jordan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Jaakkola-Jordan update of variational parameters — jaakkola_jordan","text":"X design matrix y response vector eta1 current value 1st natural parameter eta2 current value 2nd natural parameter eta1_p prior value 1st natural parameter eta2_p prior value 2nd natural parameter","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/jaakkola_jordan_n.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Jaakkola-Jordan update of variational parameters — jaakkola_jordan_n","title":"Perform Jaakkola-Jordan update of variational parameters — jaakkola_jordan_n","text":"Perform Jaakkola-Jordan update variational parameters","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/jaakkola_jordan_n.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Jaakkola-Jordan update of variational parameters — jaakkola_jordan_n","text":"","code":"jaakkola_jordan_n(X, y, n, eta1, eta2, eta1_p, eta2_p)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/jaakkola_jordan_n.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Jaakkola-Jordan update of variational parameters — jaakkola_jordan_n","text":"X design matrix y response vector n trial vector eta1 current value 1st natural parameter eta2 current value 2nd natural parameter eta1_p prior value 1st natural parameter eta2_p prior value 2nd natural parameter","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/knowles_minka_wand.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Knowles-Minka-Wand update of variational parameters — knowles_minka_wand","title":"Perform Knowles-Minka-Wand update of variational parameters — knowles_minka_wand","text":"Perform Knowles-Minka-Wand update variational parameters","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/knowles_minka_wand.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Knowles-Minka-Wand update of variational parameters — knowles_minka_wand","text":"","code":"knowles_minka_wand(X, y, eta1, eta2, eta1_p, eta2_p, MS_p, MS_s)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/knowles_minka_wand.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Knowles-Minka-Wand update of variational parameters — knowles_minka_wand","text":"X design matrix y response vector eta1 current value 1st natural parameter eta2 current value 2nd natural parameter eta1_p prior value 1st natural parameter eta2_p prior value 2nd natural parameter MS_p MS_s ","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/knowles_minka_wand_n.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Knowles-Minka-Wand update of variational parameters — knowles_minka_wand_n","title":"Perform Knowles-Minka-Wand update of variational parameters — knowles_minka_wand_n","text":"Perform Knowles-Minka-Wand update variational parameters","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/knowles_minka_wand_n.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Knowles-Minka-Wand update of variational parameters — knowles_minka_wand_n","text":"","code":"knowles_minka_wand_n(X, y, n, eta1, eta2, eta1_p, eta2_p, MS_p, MS_s)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/knowles_minka_wand_n.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Knowles-Minka-Wand update of variational parameters — knowles_minka_wand_n","text":"X design matrix y response vector n trials vector eta1 current value 1st natural parameter eta2 current value 2nd natural parameter eta1_p prior value 1st natural parameter eta2_p prior value 2nd natural parameter MS_p MS_s ","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/lmvgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Log multivariate Gamma function — lmvgamma","title":"Log multivariate Gamma function — lmvgamma","text":"Log transformation multivariate gamma function.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/lmvgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log multivariate Gamma function — lmvgamma","text":"","code":"lmvgamma(x, p = 1L)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/lmvgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log multivariate Gamma function — lmvgamma","text":"x value evaluate p dimension","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mfvb.control.html","id":null,"dir":"Reference","previous_headings":"","what":"Control arguments for mfvb functions — mfvb.control","title":"Control arguments for mfvb functions — mfvb.control","text":"`control` argument","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mfvb.control.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control arguments for mfvb functions — mfvb.control","text":"","code":"mfvb.control(tol = 1e-08, maxiter = 100, verbose = FALSE)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/mfvb.control.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control arguments for mfvb functions — mfvb.control","text":"tol positive convergence tolerance ELBO maxiter integer giving maximal number iterations verbose logical indicating output printed iteration","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mfvb.control.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control arguments for mfvb functions — mfvb.control","text":"list named components","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mfvb_lm.html","id":null,"dir":"Reference","previous_headings":"","what":"#' mfvb_lm.fit\n#' \n#' @param x The x input\n#' @param y The response\n#' @param weights weighting\n#' @param subset subset of data\n#' @param na.action handling of na\n#' @param offset Offset term\n#' @param control Control terms\n#' \n#' @return x if all checks pass\nmfvb_lm.fit <- function(\n  x = stop(","title":"#' mfvb_lm.fit\n#' \n#' @param x The x input\n#' @param y The response\n#' @param weights weighting\n#' @param subset subset of data\n#' @param na.action handling of na\n#' @param offset Offset term\n#' @param control Control terms\n#' \n#' @return x if all checks pass\nmfvb_lm.fit <- function(\n  x = stop(","text":"Fit linear regression model using mean-field variational Bayes approximation.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mfvb_lm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"#' mfvb_lm.fit\n#' \n#' @param x The x input\n#' @param y The response\n#' @param weights weighting\n#' @param subset subset of data\n#' @param na.action handling of na\n#' @param offset Offset term\n#' @param control Control terms\n#' \n#' @return x if all checks pass\nmfvb_lm.fit <- function(\n  x = stop(","text":"","code":"mfvb_lm(   formula,   data,   subset,   weights,   na.action,   prior = NULL,   contrasts = NULL,   x = FALSE,   y = FALSE,   ... )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/mfvb_lm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"#' mfvb_lm.fit\n#' \n#' @param x The x input\n#' @param y The response\n#' @param weights weighting\n#' @param subset subset of data\n#' @param na.action handling of na\n#' @param offset Offset term\n#' @param control Control terms\n#' \n#' @return x if all checks pass\nmfvb_lm.fit <- function(\n  x = stop(","text":"formula object class  [stats::formula]. data optional data frame, list environment  (object coercible .data.frame data frame)  containing variables model. found data,  variables taken environment(formula),  typically environment lm called. subset subset data weights weighting na.action handling na prior list elements (mu0, Sigma0, , b) giving model prior parameters. contrasts design contrasts x return design matrix y return response vector ... arguments `vb_lm`","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mfvb_lm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"#' mfvb_lm.fit\n#' \n#' @param x The x input\n#' @param y The response\n#' @param weights weighting\n#' @param subset subset of data\n#' @param na.action handling of na\n#' @param offset Offset term\n#' @param control Control terms\n#' \n#' @return x if all checks pass\nmfvb_lm.fit <- function(\n  x = stop(","text":"`mfvb` object","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvdigamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate digamma function — mvdigamma","title":"Multivariate digamma function — mvdigamma","text":"Derivative multivariate Gamma function.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvdigamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate digamma function — mvdigamma","text":"","code":"mvdigamma(x, p = 1L)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvdigamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate digamma function — mvdigamma","text":"x value evaluate p dimension","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"multivariate Gamma function — mvgamma","title":"multivariate Gamma function — mvgamma","text":"multivariate gamma function.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"multivariate Gamma function — mvgamma","text":"","code":"mvgamma(x, p = 1L)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"multivariate Gamma function — mvgamma","text":"x value evaluate p dimension","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvn_E_lpdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate E_q[ln p(x)] where q(x) = MVN(x | mu, Sigma) and p(x) = MVN(x | mu0, Sigma0) — mvn_E_lpdf","title":"Calculate E_q[ln p(x)] where q(x) = MVN(x | mu, Sigma) and p(x) = MVN(x | mu0, Sigma0) — mvn_E_lpdf","text":"E_q[ln p(x)] x ~ MVN(mu0, Sigma0) q(x) = MVN(x | mu, Sigma)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvn_E_lpdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate E_q[ln p(x)] where q(x) = MVN(x | mu, Sigma) and p(x) = MVN(x | mu0, Sigma0) — mvn_E_lpdf","text":"","code":"mvn_E_lpdf(mu0, Sigma0, mu, Sigma)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvn_E_lpdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate E_q[ln p(x)] where q(x) = MVN(x | mu, Sigma) and p(x) = MVN(x | mu0, Sigma0) — mvn_E_lpdf","text":"mu0 Mean prior Sigma0 Covariance prior mu Variational mean Sigma Variational covariance","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvn_entropy.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate Normal Entropy H[x] — mvn_entropy","title":"Multivariate Normal Entropy H[x] — mvn_entropy","text":"Calculate return entropy multivariate distribution supplied covariance matrix.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvn_entropy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate Normal Entropy H[x] — mvn_entropy","text":"","code":"mvn_entropy(S)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/mvn_entropy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate Normal Entropy H[x] — mvn_entropy","text":"S Covariance matrix","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ph_exponential.html","id":null,"dir":"Reference","previous_headings":"","what":"Normal parametric variational Bayes for Exponential PH Model. — ph_exponential","title":"Normal parametric variational Bayes for Exponential PH Model. — ph_exponential","text":"Perform Normal approximation variational inference  proportional-hazards model exponential base.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ph_exponential.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normal parametric variational Bayes for Exponential PH Model. — ph_exponential","text":"","code":"ph_exponential(   X,   y,   v,   mu0,   Sigma0,   tol = 1e-08,   maxiter = 100L,   verbose = FALSE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/ph_exponential.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normal parametric variational Bayes for Exponential PH Model. — ph_exponential","text":"X design matrix y response vector v censoring vector mu0 prior mean beta Sigma0 prior covariance beta tol tolerance convergence ELBO maxiter maximum number iterations allowed verbose Print trace lower bound console. Default FALSE.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/ph_exponential.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normal parametric variational Bayes for Exponential PH Model. — ph_exponential","text":"list containing: converged Indicator algorithm convergence. elbo Vector ELBO sequence. mu optimised value mu. Sigma optimised value Sigma.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/pnorm_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate standard normal cdf for matrix of variates — pnorm_mat","title":"Evaluate standard normal cdf for matrix of variates — pnorm_mat","text":"Evaluate standard normal cdf matrix variates","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/pnorm_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate standard normal cdf for matrix of variates — pnorm_mat","text":"","code":"pnorm_mat(m)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/pnorm_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate standard normal cdf for matrix of variates — pnorm_mat","text":"m matrix variates","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/sample_vbdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from MFVB fit — sample_vbdist","title":"Sample from MFVB fit — sample_vbdist","text":"Sample MFVB fit","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/sample_vbdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from MFVB fit — sample_vbdist","text":"","code":"sample_vbdist(object, par = NULL, n_samples = 1000)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/sample_vbdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from MFVB fit — sample_vbdist","text":"object object class `mfvb` par character vector indicating distributions sample n_samples number samples draw","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/sample_vbdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from MFVB fit — sample_vbdist","text":"matrix draws indicated distributions","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/saul_jordan.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Saul-Jordan update of variational parameters — saul_jordan","title":"Perform Saul-Jordan update of variational parameters — saul_jordan","text":"Perform Saul-Jordan update variational parameters","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/saul_jordan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Saul-Jordan update of variational parameters — saul_jordan","text":"","code":"saul_jordan(X, y, eta1, eta2, eta1_p, eta2_p, omega1)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/saul_jordan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Saul-Jordan update of variational parameters — saul_jordan","text":"X design matrix y response vector eta1 current value 1st natural parameter eta2 current value 2nd natural parameter eta1_p prior value 1st natural parameter eta2_p prior value 2nd natural parameter omega1 current value Omega1 variational parameter","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/saul_jordan_n.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Saul-Jordan update of variational parameters — saul_jordan_n","title":"Perform Saul-Jordan update of variational parameters — saul_jordan_n","text":"Perform Saul-Jordan update variational parameters","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/saul_jordan_n.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Saul-Jordan update of variational parameters — saul_jordan_n","text":"","code":"saul_jordan_n(X, y, n, eta1, eta2, eta1_p, eta2_p, omega1)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/saul_jordan_n.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Saul-Jordan update of variational parameters — saul_jordan_n","text":"X design matrix y response vector n trial vector eta1 current value 1st natural parameter eta2 current value 2nd natural parameter eta1_p prior value 1st natural parameter eta2_p prior value 2nd natural parameter omega1 current value Omega1 variational parameter","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E.html","id":null,"dir":"Reference","previous_headings":"","what":"Scaled Inverse Chi squared E[x] — scaled_inv_chisq_E","title":"Scaled Inverse Chi squared E[x] — scaled_inv_chisq_E","text":"Calculate E[x] x ~ Scaled-Inv-Chisq(nu, tau)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scaled Inverse Chi squared E[x] — scaled_inv_chisq_E","text":"","code":"scaled_inv_chisq_E(nu, tau)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scaled Inverse Chi squared E[x] — scaled_inv_chisq_E","text":"nu shape tau scale","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E_inv.html","id":null,"dir":"Reference","previous_headings":"","what":"Scaled Inverse Chi squared E[1/x] — scaled_inv_chisq_E_inv","title":"Scaled Inverse Chi squared E[1/x] — scaled_inv_chisq_E_inv","text":"Calculate E[1/x] x ~ Scaled-Inv-Chisq(nu, tau^2)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E_inv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scaled Inverse Chi squared E[1/x] — scaled_inv_chisq_E_inv","text":"","code":"scaled_inv_chisq_E_inv(nu, tau)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E_inv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scaled Inverse Chi squared E[1/x] — scaled_inv_chisq_E_inv","text":"nu shape tau scale","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E_log.html","id":null,"dir":"Reference","previous_headings":"","what":"Scaled Inverse Chi squared E[log(x)] — scaled_inv_chisq_E_log","title":"Scaled Inverse Chi squared E[log(x)] — scaled_inv_chisq_E_log","text":"Calculate E[log(x)] x ~ Scaled-Inv-Chisq(nu, tau).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E_log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scaled Inverse Chi squared E[log(x)] — scaled_inv_chisq_E_log","text":"","code":"scaled_inv_chisq_E_log(nu, tau)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_E_log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scaled Inverse Chi squared E[log(x)] — scaled_inv_chisq_E_log","text":"nu shape tau scale","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_H.html","id":null,"dir":"Reference","previous_headings":"","what":"Scaled Inverse Chi squared H[x] — scaled_inv_chisq_H","title":"Scaled Inverse Chi squared H[x] — scaled_inv_chisq_H","text":"Calculate H[x] x ~ Scaled-Inv-Chisq(nu, tau)","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_H.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scaled Inverse Chi squared H[x] — scaled_inv_chisq_H","text":"","code":"scaled_inv_chisq_H(nu, tau)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/scaled_inv_chisq_H.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scaled Inverse Chi squared H[x] — scaled_inv_chisq_H","text":"nu shape tau scale","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/solve_two_level_sparse.html","id":null,"dir":"Reference","previous_headings":"","what":"Solve two level sparse matrix problem. — solve_two_level_sparse","title":"Solve two level sparse matrix problem. — solve_two_level_sparse","text":"Solve two level sparse matrix problem.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/solve_two_level_sparse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Solve two level sparse matrix problem. — solve_two_level_sparse","text":"","code":"solve_two_level_sparse(a1, A11, a2, A22, A12)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/solve_two_level_sparse.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Solve two level sparse matrix problem. — solve_two_level_sparse","text":"a1 vector A11 matrix a2 list vectors A22 list matrices A12 list matrices","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/summary.mfvb.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise MFVB fit — summary.mfvb","title":"Summarise MFVB fit — summary.mfvb","text":"Summarise MFVB fit","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/summary.mfvb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise MFVB fit — summary.mfvb","text":"","code":"# S3 method for mfvb summary(object, ...)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/summary.mfvb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise MFVB fit — summary.mfvb","text":"object object class `mfvb` ... Unused","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/update_vb_lm.html","id":null,"dir":"Reference","previous_headings":"","what":"Update mean-field variational inference for a normal linear model. — update_vb_lm","title":"Update mean-field variational inference for a normal linear model. — update_vb_lm","text":"Update mean-field variational inference normal linear model.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/update_vb_lm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update mean-field variational inference for a normal linear model. — update_vb_lm","text":"","code":"update_vb_lm(vb_fit, X, y, tol = 1e-08, maxiter = 100L, verbose = FALSE)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/update_vb_lm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update mean-field variational inference for a normal linear model. — update_vb_lm","text":"vb_fit previous fit X new design matrix y new response vector tol Tolerance convergence elbo maxiter Maximum number iterations allowed verbose Print trace lower bound console. Default FALSE.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/update_vb_lm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update mean-field variational inference for a normal linear model. — update_vb_lm","text":"v list relevant outputs","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/varapproxr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Variational approximations — varapproxr-package","title":"Variational approximations — varapproxr-package","text":"Repository variational approximation implementations R. Currently focuses deterministic semiparametric approaches, particular, normal approximations.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/varapproxr-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variational approximations — varapproxr-package","text":"DESCRIPTION file: package yet installed build time.   Index:  package yet installed build time.  ~~ overview use package, including important functions ~~","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/varapproxr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Variational approximations — varapproxr-package","text":"NA Maintainer: NA","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/varapproxr-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Variational approximations — varapproxr-package","text":"~~ Literature references background information ~~","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_glmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Variational Bayes for logistic mixed model. — vb_glmm","title":"Variational Bayes for logistic mixed model. — vb_glmm","text":"Variational Bayes logistic mixed model.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_glmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variational Bayes for logistic mixed model. — vb_glmm","text":"","code":"vb_glmm(   X,   Z,   y,   mu_beta,   sigma_beta,   mu,   sigma,   Au = 1,   Bu = 1,   Bqu = 1,   tol = 1e-08,   maxiter = 100L,   verbose = FALSE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_glmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variational Bayes for logistic mixed model. — vb_glmm","text":"X design matrix Z Group design matrix y response vector mu_beta prior mean beta sigma_beta prior covariance beta mu Initial value mu sigma Initial value sigma Au prior shape u Bu prior scale u Bqu initial value Bqu tol Tolerance level maxiter Maximum iterations verbose Print trace lower bound console. Default FALSE.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_glmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variational Bayes for logistic mixed model. — vb_glmm","text":"list containing: converged Indicator algorithm convergence. elbo Vector ELBO sequence. mu optimised value mu. sigma optimised value sigma.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lm.html","id":null,"dir":"Reference","previous_headings":"","what":"Mean-field variational inference for a normal linear model. — vb_lm","title":"Mean-field variational inference for a normal linear model. — vb_lm","text":"Mean-field variational inference normal linear model.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mean-field variational inference for a normal linear model. — vb_lm","text":"","code":"vb_lm(   X,   y,   mu0,   Sigma0,   a0 = 0.01,   b0 = 0.01,   prior = 1L,   tol = 1e-08,   maxiter = 100L,   verbose = FALSE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mean-field variational inference for a normal linear model. — vb_lm","text":"X design matrix y response vector mu0 prior mean beta Sigma0 prior covariance beta a0 scale hyper-parameter b0 shape hyper-parameter prior prior used, `1` - inverse-gamma(a0,b0), `2`- half-t(a0,b0) tol Tolerance convergence elbo maxiter Maximum number iterations allowed verbose Print trace lower bound console. Default FALSE.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mean-field variational inference for a normal linear model. — vb_lm","text":"v list relevant outputs","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Variational Bayes for linear mixed model. — vb_lmm","title":"Variational Bayes for linear mixed model. — vb_lmm","text":"Variational approximation linear mixed model assuming Gaussian distribution priors fixed grouped effects. Priors variance parameters Scaled-Inverse-Wishart distributions.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variational Bayes for linear mixed model. — vb_lmm","text":"","code":"vb_lmm(   y,   X,   Zlist,   J,   R,   mu_beta0,   Sigma_beta0,   xi_sigma,   Lambda_sigma,   xi_k,   Lambda_k,   tol = 1e-08,   maxiter = 100L,   verbose = FALSE,   trace = FALSE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variational Bayes for linear mixed model. — vb_lmm","text":"y response vector X design matrix Zlist Collection group design matrices J First dimension Z Zlist (e.g. number subjects/sites) R Second dimension Z Zlist (e.g. number variables, intercept slope R = 2) mu_beta0 prior mean beta Sigma_beta0 prior covariance beta xi_sigma first prior parameter covariance Sigma Lambda_sigma second prior parameter covariance Sigma xi_k vector first covariance parameters hierarchical covariance Lambda_k list second covariance parameters hierarchical covariance tol Tolerance level maxiter Maximum iterations verbose Print trace lower bound console. Default FALSE. trace Print trace `mu` console.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variational Bayes for linear mixed model. — vb_lmm","text":"list containing: converged Indicator algorithm convergence. elbo Vector ELBO sequence. mu optimised value mu. Sigma optimised value Sigma.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randint.html","id":null,"dir":"Reference","previous_headings":"","what":"Variational Bayes for linear mixed model (random intercept only). — vb_lmm_randint","title":"Variational Bayes for linear mixed model (random intercept only). — vb_lmm_randint","text":"Variational Bayes linear mixed model (random intercept ).","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variational Bayes for linear mixed model (random intercept only). — vb_lmm_randint","text":"","code":"vb_lmm_randint(   X,   Z,   y,   mu_beta,   sigma_beta,   mu,   sigma,   Aeps = 1,   Beps = 1,   Au = 1,   Bu = 1,   Bqeps = 1,   Bqu = 1,   tol = 1e-08,   maxiter = 100L,   verbose = FALSE,   trace = FALSE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variational Bayes for linear mixed model (random intercept only). — vb_lmm_randint","text":"X design matrix Z Group design matrix y response vector mu_beta prior mean beta sigma_beta prior covariance beta mu Initial value mu sigma Initial value sigma Aeps prior shape sigma_eps Beps prior scale sigma_eps Au prior shape sigma_u Bu prior scale sigma_u Bqeps intial value Bqeps Bqu initial value Bqu tol Tolerance level maxiter Maximum iterations verbose Print trace lower bound console. Default FALSE. trace Print trace `mu` console.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variational Bayes for linear mixed model (random intercept only). — vb_lmm_randint","text":"list containing: converged Indicator algorithm convergence. elbo Vector ELBO sequence. mu optimised value mu. Sigma optimised value Sigma.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randint.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variational Bayes for linear mixed model (random intercept only). — vb_lmm_randint","text":"","code":"library(nlme) X <- model.matrix( ~ age + factor(Sex, levels = c(\"Female\", \"Male\")), data = Orthodont) Z <- kronecker(diag(1, 27), rep(1, 4)) y <- Orthodont$distance mu0 <- rep(0, ncol(X)) S0 <- diag(1e8, ncol(X)) mu <- rep(0, ncol(X) + ncol(Z)) S <- diag(1, ncol(X) + ncol(Z)) A <- 1/100 B <- 1/100 fit <- vb_lmm_randint(X, Z, y, mu0, S0, mu, S, A, B, A, B, verbose = TRUE) #> Iter:   1; ELBO = -312.245477 #> Iter:   2; ELBO = -260.313773 #> Iter:   3; ELBO = -259.935380 #> Iter:   4; ELBO = -259.914549 #> Iter:   5; ELBO = -259.912980 #> Iter:   6; ELBO = -259.912836 #> Iter:   7; ELBO = -259.912821 #> Iter:   8; ELBO = -259.912819 #> Iter:   9; ELBO = -259.912819 #> Iter:  10; ELBO = -259.912819 #> Iter:  11; ELBO = -259.912819"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randintslope.html","id":null,"dir":"Reference","previous_headings":"","what":"Variational Bayes for linear mixed model (random intercept and coefficient only). — vb_lmm_randintslope","title":"Variational Bayes for linear mixed model (random intercept and coefficient only). — vb_lmm_randintslope","text":"Performs variational inference random intercept coefficient model. Currently assumes groups number parameters. , Zlist elements equal dimension.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randintslope.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variational Bayes for linear mixed model (random intercept and coefficient only). — vb_lmm_randintslope","text":"","code":"vb_lmm_randintslope(   Xlist,   Zlist,   ylist,   beta_mu0,   beta_sigma0,   nu_Omega0,   lambda_Omega0,   pr_Omega = 1L,   sigma_a0 = 0.01,   sigma_b0 = 0.01,   pr_sigma = 1L,   tol = 1e-08,   maxiter = 100L,   verbose = FALSE,   trace = FALSE,   streamlined = FALSE,   use_elbo = TRUE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randintslope.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variational Bayes for linear mixed model (random intercept and coefficient only). — vb_lmm_randintslope","text":"Xlist list subject specific design matrices Zlist list subject specific group matrices ylist list subject specific responses beta_mu0 Prior mean beta beta_sigma0 Prior covariance beta nu_Omega0 Prior df Omega lambda_Omega0 Prior scale matrix Omega pr_Omega Prior type Omega - 1 IW(nu, lambda), 2 HW(nu, 2*nu*diag(1/lambda^2)) sigma_a0 first hyper-parameter prior sigma sigma_b0 second hyper-parameter prior sigma pr_sigma prior use sigma_epsilon - 1 IG(a0,b0) 2 Half-t(a0, b0) tol Tolerance level assessing convergence maxiter Maximum number fixed-update iterations verbose Print trace ELBO trace Return trace parameters beta, gamma streamlined Use streamlined updates (efficient dim(Zlist) large). use_elbo ELBO calculated used convergence checks?","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randintslope_streamlined.html","id":null,"dir":"Reference","previous_headings":"","what":"Variational Bayes for linear mixed model (random intercept and coefficient only, streamlined). — vb_lmm_randintslope_streamlined","title":"Variational Bayes for linear mixed model (random intercept and coefficient only, streamlined). — vb_lmm_randintslope_streamlined","text":"Performs variational inference random intercept coefficient model. Currently assumes groups number parameters. , Zlist elements equal dimension.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randintslope_streamlined.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variational Bayes for linear mixed model (random intercept and coefficient only, streamlined). — vb_lmm_randintslope_streamlined","text":"","code":"vb_lmm_randintslope_streamlined(   Xlist,   Zlist,   ylist,   beta_mu0,   beta_sigma0,   nu_Omega0,   lambda_Omega0,   pr_Omega = 1L,   sigma_a0 = 0.01,   sigma_b0 = 0.01,   pr_sigma = 1L,   tol = 1e-08,   maxiter = 100L,   verbose = FALSE,   trace = FALSE,   use_elbo = TRUE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_lmm_randintslope_streamlined.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variational Bayes for linear mixed model (random intercept and coefficient only, streamlined). — vb_lmm_randintslope_streamlined","text":"Xlist list subject specific design matrices Zlist list subject specific group matrices ylist list subject specific responses beta_mu0 Prior mean beta beta_sigma0 Prior covariance beta nu_Omega0 Prior df Omega lambda_Omega0 Prior scale matrix Omega pr_Omega Prior type Omega - 1 IW(nu, lambda), 2 HW(nu, 2*nu*diag(1/lambda^2)) sigma_a0 first hyper-parameter prior sigma sigma_b0 second hyper-parameter prior sigma pr_sigma prior use sigma_epsilon - 1 IG(a0,b0) 2 Half-t(a0, b0) tol Tolerance level assessing convergence maxiter Maximum number fixed-update iterations verbose Print trace ELBO trace Return trace parameters beta, gamma use_elbo ELBO calculated used convergence checks?","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_logistic.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform variational inference for logistic regression model — vb_logistic","title":"Perform variational inference for logistic regression model — vb_logistic","text":"Perform variational inference logistic regression model","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_logistic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform variational inference for logistic regression model — vb_logistic","text":"","code":"vb_logistic(   X,   y,   mu0,   Sigma0,   mu_init,   Sigma_init,   tol = 1e-08,   maxiter = 1000L,   maxiter_jj = 25L,   alg = \"jj\",   verbose = FALSE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_logistic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform variational inference for logistic regression model — vb_logistic","text":"X design matrix y response vector mu0 prior mean beta paramter Sigma0 prior variance beta parameter mu_init Initial value mu optimisation. Sigma_init Initial value Sigma optimisation. tol tolerance level assess convergence maxiter maximum number iterations maxiter_jj maximum number Jaakkola-Jordan iterations initialise estimation alg algorithm used final estimation variational parameters. verbose Print trace lower bound console. Default FALSE. Must one \"jj\", \"sj\", \"kmw\".","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_logistic_n.html","id":null,"dir":"Reference","previous_headings":"","what":"Variational inference for binomial logistic regression model — vb_logistic_n","title":"Variational inference for binomial logistic regression model — vb_logistic_n","text":"experimental function perform variational inference binomial logistic regression models.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_logistic_n.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variational inference for binomial logistic regression model — vb_logistic_n","text":"","code":"vb_logistic_n(   X,   y,   n,   mu0,   Sigma0,   mu_init,   Sigma_init,   tol = 1e-08,   maxiter = 1000L,   maxiter_jj = 25L,   alg = \"jj\",   verbose = FALSE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_logistic_n.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variational inference for binomial logistic regression model — vb_logistic_n","text":"X design matrix y response vector n trial vector mu0 prior mean beta paramter Sigma0 prior variance beta parameter mu_init Initial value mu optimisation. Sigma_init Initial value Sigma optimisation. tol tolerance level assess convergence maxiter maximum number iterations maxiter_jj maximum number Jaakkola-Jordan  iterations initialise estimation alg algorithm used final estimation  variational parameters.  Must one jj, sj, kmw. verbose Print trace lower bound console. Default FALSE.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_logistic_n.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variational inference for binomial logistic regression model — vb_logistic_n","text":"list containing: converged Indicator algorithm convergence. jj_converged Indicator convergence initial Jaakkola-Jordan iterations. elbo Vector ELBO sequence. mu optimised value mu. Sigma optimised value Sigma.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_logistic_n.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variational inference for binomial logistic regression model — vb_logistic_n","text":"default, algorithm always intialises Jaakkola-Jordan updates   convergence maxiter_jj.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_pois_mm.html","id":null,"dir":"Reference","previous_headings":"","what":"Poisson Mixed Effects Model — vb_pois_mm","title":"Poisson Mixed Effects Model — vb_pois_mm","text":"Perform mean-field variational inference  Poisson mixed-effects regression model.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_pois_mm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Poisson Mixed Effects Model — vb_pois_mm","text":"","code":"vb_pois_mm(   X,   Zlist,   y,   n,   mu0,   Sigma0,   a0,   tol = 1e-08,   maxiter = 100L,   verbose = FALSE )"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_pois_mm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Poisson Mixed Effects Model — vb_pois_mm","text":"X design matrix Zlist random effect design matrices y response vector n offset term mu0 prior mean beta Sigma0 prior covariance beta a0 Half-Cauchy scale hyper-parameter tol Tolerance convergence elbo maxiter Maximum number iterations allowed verbose Print trace lower bound console. Default FALSE.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_pois_mm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Poisson Mixed Effects Model — vb_pois_mm","text":"v list relevant outputs","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_pois_reg.html","id":null,"dir":"Reference","previous_headings":"","what":"Poisson regression — vb_pois_reg","title":"Poisson regression — vb_pois_reg","text":"Perform mean-field variational inference  Poisson regression model.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_pois_reg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Poisson regression — vb_pois_reg","text":"","code":"vb_pois_reg(X, y, n, mu0, Sigma0, tol = 1e-08, maxiter = 100L, verbose = FALSE)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_pois_reg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Poisson regression — vb_pois_reg","text":"X design matrix y response vector n offset term mu0 prior mean beta Sigma0 prior covariance beta tol Tolerance convergence elbo maxiter Maximum number iterations allowed verbose Print trace lower bound console. Default FALSE.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vb_pois_reg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Poisson regression — vb_pois_reg","text":"v list relevant outputs","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vcov.mfvb.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract model coefficient posterior covariance matrix — vcov.mfvb","title":"Extract model coefficient posterior covariance matrix — vcov.mfvb","text":"`vcov.mfvb` implements `vcov` generic objects class `mfvb`.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vcov.mfvb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract model coefficient posterior covariance matrix — vcov.mfvb","text":"","code":"# S3 method for mfvb vcov(object, ...)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vcov.mfvb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract model coefficient posterior covariance matrix — vcov.mfvb","text":"object `mfvb` model ... Unused","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vech.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate vech of a matrix — vech","title":"Calculate vech of a matrix — vech","text":"Calculate vech matrix","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vech.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate vech of a matrix — vech","text":"","code":"vech(X)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vech.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate vech of a matrix — vech","text":"X square matrix dimension d d","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vmp_lm.html","id":null,"dir":"Reference","previous_headings":"","what":"Variational Message Passing for Normal linear model. — vmp_lm","title":"Variational Message Passing for Normal linear model. — vmp_lm","text":"Variational Message Passing Normal linear model.","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/vmp_lm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variational Message Passing for Normal linear model. — vmp_lm","text":"","code":"vmp_lm(n, X, y, mu0, Sigma0, A, maxiter = 100L, tol = 1e-10, verbose = TRUE)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/vmp_lm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variational Message Passing for Normal linear model. — vmp_lm","text":"n Number rows X design matrix n d. y observation vector n 1. mu0 prior mean coefficients Sigma0 prior variance coefficients prior scale variance maxiter maximum number iterations tol Tolerance convergence verbose Print trace ELBO","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/woodbury.html","id":null,"dir":"Reference","previous_headings":"","what":"Woodbury matrix identity — woodbury","title":"Woodbury matrix identity — woodbury","text":"(+ BCD)^-1","code":""},{"path":"https://jatotterdell.github.io/varapproxr/reference/woodbury.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Woodbury matrix identity — woodbury","text":"","code":"woodbury(A, B, C, D)"},{"path":"https://jatotterdell.github.io/varapproxr/reference/woodbury.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Woodbury matrix identity — woodbury","text":"mat B mat B C mat C D mat D","code":""}]
